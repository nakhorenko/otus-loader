## Попасть в систему тремя разными способами.

**Первый способ**

В момент загрузки нажимаем "е" и попадаем в редактор загрузки Граб.

Находим строку, начинающуюся со слова "linux" и в конце строки пишем "init=/bin/bash".
Далее нажимаем ctrl+x и попадаем в bash.

Корень примонтирован только на чтение, выполняем

```
mount -o remount,rw /
```
И меняем пароль
```
passwd

New pass
Retry new pass

/sbin/reboot -f
```
**Второй способ**

В момент загрузки снова нажимаем "е"

Далее в конец строки "linux" пишем rd.break и ctrl+x
Попадаем в emergency mode

```
mount -o remount,rw /sysroot
chroot /sysroot
```
далее меняем пароль и заходим с новым паролем

**Третий способ**

В конце той же строки меняем ro на rw init=/bin/bash, тем самым корень смонтирован сразу на запись. Можно запускать exec /sbin/init

## Установить систему с LVM, после чего переименовать VG

```
[root@otusloader ~]# lvs
  LV       VG         Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
  LogVol00 VolGroup00 -wi-ao---- <37.47g                                                    
  LogVol01 VolGroup00 -wi-ao----   1.50g       
					 
[root@otusloader ~]# vgs
  VG         #PV #LV #SN Attr   VSize   VFree
  VolGroup00   1   2   0 wz--n- <38.97g    0 

[root@otusloader ~]# pvs
  PV         VG         Fmt  Attr PSize   PFree
  /dev/sda3  VolGroup00 lvm2 a--  <38.97g    0 
```
Меняем имя VG:
```
[root@otusloader ~]# vgrename VolGroup00 OtusRoot
  Volume group "VolGroup00" successfully renamed to "OtusRoot"
```
Редактируем /etc/fstab, /etc/default/grub, /boot/grub2/grub.cfg

```
# /etc/fstab
# Created by anaconda on Sat May 12 18:50:26 2018
#
# Accessible filesystems, by reference, are maintained under '/dev/disk'
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info
#
/dev/mapper/OtusRoot-LogVol00 /                       xfs     defaults        0 0
UUID=570897ca-e759-4c81-90cf-389da6eee4cc /boot                   xfs     defaults        0 0
/dev/mapper/OtusRoot-LogVol01 swap                    swap    defaults        0 0
#VAGRANT-BEGIN
# The contents below are automatically generated by Vagrant. Do not modify.
#VAGRANT-END
```
/etc/default/grub
```
GRUB_TIMEOUT=1
GRUB_DISTRIBUTOR="$(sed 's, release .*$,,g' /etc/system-release)"
GRUB_DEFAULT=saved
GRUB_DISABLE_SUBMENU=true
GRUB_TERMINAL_OUTPUT="console"
GRUB_CMDLINE_LINUX="no_timer_check console=tty0 console=ttyS0,115200n8 net.ifnames=0 biosdevname=0 elevator=noop crashkernel=auto rd.lvm.lv=OtusRoot/LogVol00 rd.lvm.lv=OtusRoot/LogVol01 rhgb quiet"
GRUB_DISABLE_RECOVERY="true"
```
/boot/grub2/grub.cfg
```
[root@otusloader ~]# cat /boot/grub2/grub.cfg | grep OtusRoot
	linux16 /vmlinuz-3.10.0-862.2.3.el7.x86_64 root=/dev/mapper/OtusRoot-LogVol00 ro no_timer_check console=tty0 console=ttyS0,115200n8 net.ifnames=0 biosdevname=0 elevator=noop crashkernel=auto rd.lvm.lv=OtusRoot/LogVol00 rd.lvm.lv=OtusRoot/LogVol01 rhgb quiet 
```

Пересоздаем initrd 
```
[root@otusloader ~]# mkinitrd -f -v /boot/initramfs-$(uname -r).img $(uname -r)
************************
					  
*** No early-microcode cpio image needed ***
*** Store current command line parameters ***
*** Creating image file ***
*** Creating image file done ***
*** Creating initramfs image file '/boot/initramfs-3.10.0-862.2.3.el7.x86_64.img' done ***
```
далее reboot и 
```
vagrant ssh
[root@otusloader ~]# vgs
  VG       #PV #LV #SN Attr   VSize   VFree
  OtusRoot   1   2   0 wz--n- <38.97g    0 
```
## Добавляем модуль в initrd

```
[root@otusloader modules.d ~]# sudo !!
sudo mkdir 01test

nano module_setup.sh
[root@otusloader modules.d ~]# nano test.sh
[root@otusloader modules.d ~]# chmod +x module_setup.sh && chmod +x test.s

[root@otusloader modules.d ~]# cp module_setup.sh /usr/lib/dracut/modules.d/01test/
[root@otusloader modules.d ~]# cp test.sh /usr/lib/dracut/modules.d/01test/

[root@otusloader modules.d ~]# mkinitrd -f -v /boot/initramfs-$(uname -r).img $(uname -r)
*** Creating image file ***
*** Creating image file done ***
*** Creating initramfs image file '/boot/initramfs-3.10.0-1127.el7.x86_64.img' done ***
```
